(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{107:function(e,t,n){e.exports=n.p+"static/media/secret-agent.f4720874.svg"},197:function(e,t,n){e.exports=n.p+"static/media/soldier.1cc063fe.svg"},310:function(e,t,n){e.exports=n.p+"static/media/anonymous.6898e435.svg"},311:function(e,t,n){e.exports=n.p+"static/media/captain.fc758069.svg"},312:function(e,t,n){e.exports=n.p+"static/media/captain-red.09706776.svg"},313:function(e,t,n){e.exports=n.p+"static/media/ninja.9ff8d9ba.svg"},314:function(e,t,n){e.exports=n.p+"static/media/bodyguard.fb712ee8.svg"},343:function(e,t,n){e.exports=n(689)},348:function(e,t,n){},473:function(e,t){},475:function(e,t){},507:function(e,t){},508:function(e,t){},688:function(e,t,n){},689:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(48),c=n.n(o),i=(n(348),n(21)),s=n(22),u=n(23),l=n(25),m=n(24),d=n(26),p=n(697),E=n(696),f=n(699),h=n(700),b=n(17),O=n(36),v=n(16),g=n.n(v),S=n(28),j=n(196),N=n.n(j),C=(n(402),{apiKey:"AIzaSyCVuB9PRtMCoDcYNR70NWWtTuJu3GU0FKM",authDomain:"random-role.firebaseapp.com",databaseURL:"https://random-role.firebaseio.com",projectId:"random-role",storageBucket:"random-role.appspot.com",messagingSenderId:"71043698352"});N.a.initializeApp({apiKey:C.apiKey,authDomain:C.authDomain,projectId:C.projectId});var R,y,D,A=N.a.firestore(),k={NEW:"NEW",STARTED:"STARTED",FINISHED:"FINISHED"},I={BAD:"BAD",GOOD:"GOOD",RANDOM:"RANDOM"},T={CLASSIC:"CLASSIC",AVALON:"AVALON"},w={PREPARE:"PREPARE",VOTE:"VOTE",PROGRESS:"PROGRESS",REJECTED:"REJECTED",SUCCESS:"SUCCESS",FAIL:"FAIL",isTerminal:function(e){return e===w.REJECTED||e===w.SUCCESS||e===w.FAIL},isLater:function(e,t){var n=x.indexOf(e),a=x.indexOf(t);return-1!==n&&(-1===a||a>n)}},x=[w.PREPARE,w.VOTE,w.PROGRESS],M={YES:"YES",NO:"NO"},F={SUCCESS:"SUCCESS",FAIL:"FAIL",REVERSE:"REVERSE",CHIEF_FAIL:"CHIEF_FAIL"},P=(R={},Object(b.a)(R,w.SUCCESS,"Successful"),Object(b.a)(R,w.FAIL,"Failed"),Object(b.a)(R,w.PROGRESS,"In progress"),Object(b.a)(R,w.REJECTED,"Rejected"),Object(b.a)(R,w.VOTE,"Team election"),Object(b.a)(R,w.PREPARE,""),R),L=n(197),B=n.n(L),Y=n(107),G=n.n(Y),_=n(310),U=n.n(_),V=n(311),W=n.n(V),H=n(312),J=n.n(H),K=n(313),z=n.n(K),q=n(314),Q=n.n(q),X={RESISTANCE:"RESISTANCE",SPY:"SPY",BODY_GUARD:"BODY_GUARD",COMMANDER:"COMMANDER",FALSE_COMMANDER:"FALSE_COMMANDER",ASSASSIN:"ASSASSIN",UNKNOWN:"UNKNOWN",SPY_DEFECTOR:"SPY_DEFECTOR",DEFECTOR:"DEFECTOR",DEEP_COVER_SPY:"DEEP_COVER_SPY",BLIND_SPY:"BLIND_SPY"},Z=(y={},Object(b.a)(y,X.ASSASSIN,{id:X.ASSASSIN,side:I.BAD,title:"Assassin",icon:z.a,core:!0}),Object(b.a)(y,X.FALSE_COMMANDER,{id:X.FALSE_COMMANDER,side:I.BAD,title:"False Commander",icon:J.a,info:"Appears as Commander"}),Object(b.a)(y,X.SPY,{id:X.SPY,side:I.BAD,title:"Government spy",icon:G.a,base:!0}),Object(b.a)(y,X.COMMANDER,{id:X.COMMANDER,side:I.GOOD,title:"Commander",icon:W.a,core:!0,info:"Knows spies"}),Object(b.a)(y,X.BODY_GUARD,{id:X.BODY_GUARD,side:I.GOOD,title:"Bodyguard",icon:Q.a,info:"Knows commanders"}),Object(b.a)(y,X.RESISTANCE,{id:X.RESISTANCE,side:I.GOOD,title:"Member of the Resistance",icon:B.a,base:!0}),Object(b.a)(y,X.UNKNOWN,{id:X.UNKNOWN,icon:U.a}),Object(b.a)(y,X.SPY_DEFECTOR,{id:X.SPY_DEFECTOR,side:I.BAD,title:"Spy Defector",icon:G.a,info:"Might switch side"}),Object(b.a)(y,X.DEFECTOR,{id:X.DEFECTOR,side:I.GOOD,title:"Defector",icon:B.a,info:"Might switch side"}),Object(b.a)(y,X.DEEP_COVER_SPY,{id:X.DEEP_COVER_SPY,side:I.BAD,title:"Deep cover Spy",icon:G.a,info:"Unknown to Commander"}),Object(b.a)(y,X.BLIND_SPY,{id:X.BLIND_SPY,side:I.BAD,title:"Blind Spy",icon:G.a,info:"Unknown to other spies"}),y),$=(D={},Object(b.a)(D,I.BAD,{color:"spy text",title:"The Spies",success:["3 Missions fail","Commander named by the Assassin"]}),Object(b.a)(D,I.GOOD,{color:"resistance text",title:"The Resistance",success:["3 Missions are completed successfully"],fail:["Commander named by the Spies"]}),D);function ee(e,t){var n=function(e){var t,n,a=e.reduce(function(e,t,n){return Object(i.a)({},e,Object(b.a)({},t,[].concat(Object(O.a)(e[t]),[n])))},(t={},Object(b.a)(t,I.BAD,[]),Object(b.a)(t,I.GOOD,[]),Object(b.a)(t,I.RANDOM,[]),t)),r=[].concat(Object(O.a)(te(a[I.GOOD])),Object(O.a)(te(a[I.RANDOM])),Object(O.a)(te(a[I.BAD])));return n={},Object(b.a)(n,I.BAD,r.slice(ne[r.length])),Object(b.a)(n,I.GOOD,r.slice(0,ne[r.length])),n}(e),a=Array(e.length),r=te(n[I.GOOD]),o=te(n[I.BAD]);for([].concat(Object(O.a)(t.filter(function(e){return Z[e].core})),Object(O.a)(te(t.filter(function(e){return!Z[e].core})))).forEach(function(e){Z[e].side===I.GOOD&&r.length?a[r.shift()]=e:Z[e].side===I.BAD&&o.length&&(a[o.shift()]=e)});r.length>0;)a[r.shift()]=X.RESISTANCE;for(;o.length>0;)a[o.shift()]=X.SPY;return a}function te(e){for(var t=e.slice(),n=t.length-1;n>0;n--){var a=Math.floor(Math.random()*(n+1)),r=[t[a],t[n]];t[n]=r[0],t[a]=r[1]}return t}var ne={5:3,6:4,7:4,8:5,9:6,10:6,11:7};function ae(e,t){switch(e){case X.SPY:case X.FALSE_COMMANDER:case X.ASSASSIN:case X.DEEP_COVER_SPY:return Z[t].side===I.GOOD?X.RESISTANCE:X.SPY;case X.BODY_GUARD:return t===X.COMMANDER||t===X.FALSE_COMMANDER?X.COMMANDER:X.UNKNOWN;case X.COMMANDER:return t===X.DEEP_COVER_SPY?X.RESISTANCE:Z[t].side===I.GOOD?X.RESISTANCE:X.SPY;default:return X.UNKNOWN}}function re(e){return 2===e.filter(function(e){return e===X.SPY_DEFECTOR||e===X.DEFECTOR}).length?[Math.ceil(7*Math.random()),Math.ceil(7*Math.random())]:[]}function oe(e){return e.map(function(e){return e.role===X.DEFECTOR?Object(i.a)({},e,{role:X.SPY_DEFECTOR}):e.role===X.SPY_DEFECTOR?Object(i.a)({},e,{role:X.DEFECTOR}):e})}var ce=n(143),ie=n.n(ce);var se={vote:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M.YES,a=Object(i.a)({},t);return e.forEach(function(e,t){e.bot&&!a[t]&&(a[t]=n)}),a},createBot:function(){var e=ie.a.make("{{adjective}} {{noun}}");return{login:e[0].toUpperCase()+e.slice(1),prefSide:I.RANDOM,bot:!0}},doMission:function(e,t){var n=Object(i.a)({},t);return e.forEach(function(e,t){e.bot&&!n[t]&&(n[t]=Z[e.role].side===I.GOOD?F.SUCCESS:F.FAIL)}),n},proposeTeam:function(e,t,n){for(var a=[],r=0;r<ue[e.length][n];r++){var o=t+r;o>=e.length&&(o-=e.length),a.push(o)}return a}},ue={5:[2,3,2,3,3],6:[2,3,4,3,4],7:[2,3,3,4,4],8:[3,4,4,5,5],9:[3,4,4,5,5],10:[3,4,4,5,5],11:[3,4,4,6,6]};function le(e){var t;return e.reduce(function(e,t){return t.status===w.FAIL?Object(i.a)({},e,Object(b.a)({},I.BAD,1+e[I.BAD])):t.status===w.SUCCESS?Object(i.a)({},e,Object(b.a)({},I.GOOD,1+e[I.GOOD])):e},(t={},Object(b.a)(t,I.GOOD,0),Object(b.a)(t,I.BAD,0),t))}function me(e,t){var n,a,r=e?e.status===w.REJECTED?e.num:e.num+1:0,o=e?(n=e.leader,a=t.length,n<a-1?n+1:0):Math.floor(Math.random()*t.length);return{num:r,leader:o,participants:t[o].bot?se.proposeTeam(t,o,r):[],vote:[],status:t[o].bot?w.VOTE:w.PREPARE,name:ie.a.make("{{adjective}} {{noun}}")}}function de(e,t){var n,a=Object.values(e).reduce(function(e,t){return Object(i.a)({},e,Object(b.a)({},t,1+e[t]))},(n={},Object(b.a)(n,M.YES,0),Object(b.a)(n,M.NO,0),n));return a[M.YES]+a[M.NO]===t&&(a[M.YES]>a[M.NO]?w.PROGRESS:w.REJECTED)}function pe(e,t,n){var a=function(e,t,n){var a=Object.values(e);return ue[t][n]===a.length&&a.reduce(function(e,t){return Object(i.a)({},e,Object(b.a)({},t,1+(e[t]||0)))},{})}(e,t,n);return console.log(a),a?{result:e,summary:a,status:a[F.FAIL]>=function(e,t){return e>=7&&3===t?2:1}(t,n)?w.FAIL:w.SUCCESS}:{result:e}}function Ee(){return(Ee=Object(S.a)(g.a.mark(function e(t,n,a){var r,o;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=ye(),e.next=3,A.collection("rooms").add({members:[{login:n,prefSide:a,host:!0,secret:r}],status:k.NEW});case 3:return o=e.sent,e.abrupt("return",{roomId:o.id,secret:r,login:n});case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function fe(){return(fe=Object(S.a)(g.a.mark(function e(t,n,a){var r,o;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=A.collection("rooms").doc(t),o=ye(),e.next=4,A.runTransaction(function(){var e=Object(S.a)(g.a.mark(function e(t){var c,s;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.get();case 2:if((c=e.sent).exists){e.next=5;break}throw new Error("Room not found");case 5:if(!(s=c.data()).members.some(function(e){return e.login===n})){e.next=8;break}throw new Error("Login is in use");case 8:if(s.status===k.NEW){e.next=10;break}throw new Error("The game has been started");case 10:t.update(r,Object(i.a)({},s,{members:[].concat(Object(O.a)(s.members),[{login:n,prefSide:a,secret:o}])}));case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 4:return e.abrupt("return",{roomId:t,login:n,secret:o});case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function he(){return(he=Object(S.a)(g.a.mark(function e(t){var n;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=A.collection("rooms").doc(t),e.next=3,A.runTransaction(function(){var e=Object(S.a)(g.a.mark(function e(t){var a,r,o;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.get();case 2:a=e.sent,(r=a.data()).status===k.NEW&&r.members.length<11&&(o=se.createBot(),t.update(n,Object(i.a)({},r,{members:[].concat(Object(O.a)(r.members),[o])})));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function be(){return(be=Object(S.a)(g.a.mark(function e(t){var n,a,r,o,c;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.roomId,a=t.login,r=t.secret,o=A.collection("rooms").doc(n),e.next=4,o.get();case 4:if(!(c=e.sent).exists){e.next=14;break}if(!c.get("members").find(function(e){return e.login===a&&e.secret===r})){e.next=11;break}return e.abrupt("return",!0);case 11:return e.abrupt("return",Promise.reject(Error("Invalid credentials")));case 12:e.next=15;break;case 14:return e.abrupt("return",Promise.reject(Error("Room not found")));case 15:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Oe(){return(Oe=Object(S.a)(g.a.mark(function e(t){var n;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=A.collection("rooms").doc(t),e.next=3,A.runTransaction(function(){var e=Object(S.a)(g.a.mark(function e(t){var a,r,o,c,s,u,l,m,d;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.get();case 2:if(a=e.sent,r=a.data(),!((o=r.members.length)<5||o>11)){e.next=7;break}throw new Error("Number of players should be between 5 and 11");case 7:r.status===k.NEW&&(s=ee(r.members.map(function(e){return e.prefSide}),r.roles),u=re(s),l=r.members.map(function(e,t){return Object(i.a)({},e,{team:Z[s[t]].side,role:s[t],originalRole:s[t],num:t})}),m=me(null,l),d=Object(i.a)({},r,{members:l,status:k.STARTED,missions:[m],defectorTurn:u,score:(c={},Object(b.a)(c,I.BAD,0),Object(b.a)(c,I.GOOD,0),c)}),t.update(n,d));case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ve(){return(ve=Object(S.a)(g.a.mark(function e(t){var n;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=A.collection("rooms").doc(t),e.next=3,A.runTransaction(function(){var e=Object(S.a)(g.a.mark(function e(t){var a,r;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.get();case 2:a=e.sent,r=a.data(),t.update(n,Object(i.a)({},r,{status:k.FINISHED}));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ge(){return(ge=Object(S.a)(g.a.mark(function e(t,n){var a;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=A.collection("rooms").doc(n),e.next=3,A.runTransaction(function(){var e=Object(S.a)(g.a.mark(function e(n){var r,o,c,s;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.get();case 2:r=e.sent,(o=r.data()).status===k.NEW&&(c=o.members.find(function(e){return e.login===t}))&&(s=o.members.filter(function(e){return e.login!==t}),c.host&&s.length&&(s[0].host=!0),n.update(a,Object(i.a)({},o,{members:s})));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Se(){return(Se=Object(S.a)(g.a.mark(function e(t,n){var a;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=A.collection("rooms").doc(t),e.next=3,A.runTransaction(function(){var e=Object(S.a)(g.a.mark(function e(t){var r,o;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.get();case 2:r=e.sent,(o=r.data()).status===k.NEW&&t.update(a,Object(i.a)({},o,{roles:n}));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function je(e,t){return Ne.apply(this,arguments)}function Ne(){return(Ne=Object(S.a)(g.a.mark(function e(t,n){var a;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=A.collection("rooms").doc(t),e.next=3,A.runTransaction(function(){var e=Object(S.a)(g.a.mark(function e(t){var r,o,c;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.get();case 2:r=e.sent,(o=r.data()).status===k.STARTED&&(c=n(o.missions[o.missions.length-1],o),t.update(a,Object(i.a)({},o,{missions:[].concat(Object(O.a)(o.missions.slice(0,o.missions.length-1)),[c])})));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Ce(){return(Ce=Object(S.a)(g.a.mark(function e(t){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,je(t,function(e,t){return ue[t.members.length][e.num]===e.participants.length?Object(i.a)({},e,{status:w.VOTE}):e});case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Re(){return(Re=Object(S.a)(g.a.mark(function e(t,n,a){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,je(t,function(e,t){if(e.vote[n])return e;var r=Object(i.a)({},e.vote,Object(b.a)({},n,a));t.members[n].host&&(r=se.vote(t.members,r,a));var o=de(r,t.members.length);return o?Object(i.a)({},e,{status:o,vote:r}):Object(i.a)({},e,{vote:r})});case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ye(){return Math.random().toString(36).replace(/[^a-z]+/g,"")}function De(){return(De=Object(S.a)(g.a.mark(function e(t){var n;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=A.collection("rooms").doc(t),e.next=3,A.runTransaction(function(){var e=Object(S.a)(g.a.mark(function e(t){var a,r,o,c,s,u;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.get();case 2:if(a=e.sent,(r=a.data()).status!==k.STARTED){e.next=14;break}if(o=r.missions[r.missions.length-1],!((c=le(r.missions))[I.GOOD]>=3||c[I.BAD]>=3)){e.next=10;break}return t.update(n,Object(i.a)({},r,{status:k.FINISHED,score:c})),e.abrupt("return");case 10:s=r.members,o.status!==w.REJECTED&&r.defectorTurn.includes(o.num)&&(s=oe(s)),u=me(o,s),t.update(n,Object(i.a)({},r,{score:c,members:s,missions:[].concat(Object(O.a)(r.missions),[u])}));case 14:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Ae(){return(Ae=Object(S.a)(g.a.mark(function e(t,n,a){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,je(t,function(e,t){var r=e.result,o=void 0===r?{}:r;return o[n]=a,Object(i.a)({},e,pe(o,t.members.length,e.num))});case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ke(){return(ke=Object(S.a)(g.a.mark(function e(t){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,je(t,function(e,t){var n=se.doMission(t.members.filter(function(t){return e.participants.includes(t.num)}),e.result||[]);return Object(i.a)({},e,pe(n,t.members.length,e.num))});case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Ie={create:function(e,t,n){return Ee.apply(this,arguments)},join:function(e,t,n){return fe.apply(this,arguments)},listenRoom:function(e,t){return A.collection("rooms").doc(e).onSnapshot(t)},login:function(e){return be.apply(this,arguments)},start:function(e){return Oe.apply(this,arguments)},end:function(e){return ve.apply(this,arguments)},kick:function(e,t){return ge.apply(this,arguments)},setRoles:function(e,t){return Se.apply(this,arguments)},updateCurrentMission:je,nextMission:function(e){return De.apply(this,arguments)},addBot:function(e){return he.apply(this,arguments)},proposeTeam:function(e){return Ce.apply(this,arguments)},voteTeam:function(e,t,n){return Re.apply(this,arguments)},performMission:function(e,t,n){return Ae.apply(this,arguments)},botMissionPerfom:function(e){return ke.apply(this,arguments)}},Te=n(198),we=n.n(Te);function xe(){return window.location.search?window.location.search.slice(1):""}var Me=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(c)))).state={joinErrMsg:[],createErrMsg:[]},n.roomId=xe(),n.form=r.a.createRef(),n.joinPane=function(){var e=n.state.joinErrMsg;return r.a.createElement(p.a.Pane,null,r.a.createElement(E.a,{ref:n.form},e&&e.length>0&&r.a.createElement(f.a,{negative:!0},r.a.createElement(f.a.Header,null,"Failed to join the game"),e.map(function(e){return r.a.createElement("p",null,e)})),r.a.createElement(E.a.Field,{label:"Game ID",control:"input",name:"id",defaultValue:n.roomId}),r.a.createElement(E.a.Field,{label:"Your name",control:"input",name:"login",type:"text"}),r.a.createElement(E.a.Group,{grouped:!0},r.a.createElement("label",null,"Choose your side"),r.a.createElement(E.a.Field,{label:"Resistance",control:"input",type:"radio",name:"side",value:I.GOOD}),r.a.createElement(E.a.Field,{label:"Spies",control:"input",type:"radio",name:"side",value:I.BAD}),r.a.createElement(E.a.Field,{label:"Whatever",control:"input",type:"radio",name:"side",defaultChecked:!0,value:I.RANDOM})),r.a.createElement(h.a,{primary:!0,fluid:!0,onClick:n.onJoin},"JOIN")))},n.createPane=function(){var e=n.state.createErrMsg;return r.a.createElement(p.a.Pane,null,r.a.createElement(E.a,{ref:n.form},e&&e.length>0&&r.a.createElement(f.a,{negative:!0},r.a.createElement(f.a.Header,null,"Failed to join the game"),e.map(function(e){return r.a.createElement("p",null,e)})),r.a.createElement(E.a.Group,{grouped:!0},r.a.createElement("label",null,"Choose a game"),r.a.createElement(E.a.Field,{label:"Resistance: Hunter module",control:"input",type:"radio",name:"game",value:T.CLASSIC,defaultChecked:!0}),r.a.createElement(E.a.Field,{label:"Resistance: Assassin module",control:"input",type:"radio",name:"game",value:T.AVALON})),r.a.createElement(E.a.Field,{label:"Your name",control:"input",name:"login"}),r.a.createElement(E.a.Group,{grouped:!0},r.a.createElement("label",null,"Choose your side"),r.a.createElement(E.a.Field,{label:"Resistance",control:"input",type:"radio",value:I.GOOD,name:"side"}),r.a.createElement(E.a.Field,{label:"Spies",control:"input",type:"radio",value:I.BAD,name:"side"}),r.a.createElement(E.a.Field,{label:"Whatever",control:"input",type:"radio",name:"side",value:I.RANDOM,defaultChecked:!0})),r.a.createElement(h.a,{primary:!0,fluid:!0,onClick:n.onCreate},"CREATE")))},n.onJoin=function(){var e=n.props.onEnter,t=we()(o.findDOMNode(n.form.current),{hash:!0});t.login&&t.id&&t.side&&Ie.join(t.id,t.login,t.side).then(function(t){e&&e(t)},function(e){n.setState({joinErrMsg:[e.msg||e.message||e||"Unknown error"]})})},n.onCreate=function(){var e=we()(o.findDOMNode(n.form.current),{hash:!0}),t=n.props.onEnter;e.side&&e.login&&e.game&&Ie.create(e.game,e.login,e.side).then(function(e){t&&t(e)},function(e){n.setState({createErrMsg:[e.msg||e.message||e||"Unknown error"]})})},n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement(p.a,{panes:[{menuItem:"JOIN",render:this.joinPane},{menuItem:"CREATE",render:this.createPane}]})}}]),t}(r.a.Component),Fe=n(702),Pe=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.onTabSet;return r.a.createElement("div",{className:"ui three buttons room-menu"},r.a.createElement("button",{className:"ui button ".concat(this.btnClass(nt.MEMBERS)),onClick:function(){return e(nt.MEMBERS)}},r.a.createElement("i",{className:"eye slash icon"})),r.a.createElement("button",{className:"ui button ".concat(this.btnClass(nt.BOARD)),onClick:function(){return e(nt.BOARD)}},r.a.createElement("i",{className:"icon users"})," "),r.a.createElement("button",{className:"ui button ".concat(this.btnClass(nt.HISTORY)),onClick:function(){return e(nt.HISTORY)}},r.a.createElement("i",{className:"stack exchange icon"})))}},{key:"btnClass",value:function(e){return this.props.tab===e?"secondary":""}}]),t}(r.a.Component),Le=n(698),Be=n(332),Ye=n(58),Ge=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.user,a=t.room,o=t.onLeave,c=a.members,i=a.status,s=n.role&&Z[n.role],u=s&&$[s.side];return r.a.createElement(r.a.Fragment,null,s&&r.a.createElement("div",{className:"ui fluid card"},r.a.createElement("div",{className:"content"},r.a.createElement("img",{className:"right floated tiny ui image",src:s.icon,alt:s.title}),r.a.createElement("div",{className:"header ".concat(u.color)},s.title),r.a.createElement("div",{className:"meta"},"Allegiance: ",u.title),r.a.createElement("p",null),s.info&&r.a.createElement("p",null,s.info),r.a.createElement("div",null,"Win conditions:",r.a.createElement("ul",null,u.success&&u.success.map(function(e){return r.a.createElement("li",{className:"text success",key:e},e)}),s.fail&&s.fail.map(function(e){return r.a.createElement("li",{className:"text danger",key:e},e)}))))),r.a.createElement(Le.a,{verticalAlign:"middle",size:"large",celled:!0},c.map(function(t){var a=function(e,t,n){switch(e){case k.FINISHED:return n.role;case k.STARTED:return t.login===n.login?n.role:ae(t.role,n.originalRole);default:return X.UNKNOWN}}(i,n,t);return r.a.createElement(Le.a.Item,{key:t.login},r.a.createElement(Be.a,{avatar:!0,src:Z[a].icon}),r.a.createElement(Le.a.Content,null,r.a.createElement(Le.a.Header,null,t.login),i!==k.NEW&&r.a.createElement(Le.a.Description,null,Z[a].title)),n.host&&i===k.NEW&&r.a.createElement(Le.a.Content,{floated:"right"},r.a.createElement(h.a,{icon:!0,onClick:function(){return e.kick(t.login)},color:"red"},r.a.createElement(Ye.a,{name:"thumbs down"}))),n.host&&i!==k.NEW&&t.bot&&r.a.createElement(Le.a.Content,{floated:"right"},r.a.createElement(h.a,{icon:!0,onClick:function(){return e.setVision(t.login)},color:"blue"},r.a.createElement(Ye.a,{name:"eye"}))))})),r.a.createElement("div",{className:"ui fluid buttons"},n.host&&i===k.NEW&&r.a.createElement("button",{className:"ui primary button",onClick:function(){return e.addBot()}},"Add bot"),n.bot&&r.a.createElement("button",{className:"ui positive button",onClick:function(){return e.setVision(c.find(function(e){return e.host}).login)}},"Return to host"),r.a.createElement("button",{className:"ui negative button",onClick:o},"Leave")))}},{key:"kick",value:function(e){var t=this.props,n=t.roomId;t.api.kick(e,n)}},{key:"addBot",value:function(){var e=this.props,t=e.roomId;e.api.addBot(t)}},{key:"setVision",value:function(e){this.props.setVision&&this.props.setVision(e)}}]),t}(r.a.Component);n(688);var _e=Object.values(Z).filter(function(e){return!e.base&&e.side}),Ue=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.room,a=t.roomId,o=t.user,c=n.members,i=n.roles,s=void 0===i?[]:i;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"ui large message"},r.a.createElement("div",{className:"content"},r.a.createElement("p",null,"Waiting for other players to join"),r.a.createElement("p",null,r.a.createElement("a",{className:"roomLink",href:"?".concat(a)},"ROOM LINK")))),r.a.createElement("p",null,r.a.createElement("b",null,"People in this room (",c.length,"):")," ",c.map(function(e){return e.login}).join(", ")),r.a.createElement("p",null,r.a.createElement("b",null,"Possible roles:")," ",[X.RESISTANCE,X.SPY].concat(Object(O.a)(s)).map(function(e,t){return[t>0&&", ",r.a.createElement("span",{key:t,className:$[Z[e].side].color},Z[e].title)]})),o.host&&r.a.createElement("div",{className:"ui form"},_e.map(function(t){return r.a.createElement("div",{className:"field",key:t.id},r.a.createElement("div",{className:"ui checkbox",onClick:function(){e.toggleRole(t.id)}},r.a.createElement("input",{type:"checkbox",className:"hidden",checked:s.includes(t.id),value:t.id,onChange:function(){}}),r.a.createElement("label",null,t.title)))}),r.a.createElement("button",{className:"ui fluid positive button",onClick:function(){e.start()}},"Start")))}},{key:"toggleRole",value:function(e){var t=this.props,n=t.room.roles,a=void 0===n?[]:n,r=t.api,o=t.roomId;a.includes(e)?r.setRoles(o,a.filter(function(t){return t!==e})):r.setRoles(o,[].concat(Object(O.a)(a),[e]))}},{key:"start",value:function(){var e=this.props,t=e.room.members,n=e.api,a=e.roomId;t.length>=5&&n.start(a)}}]),t}(r.a.Component),Ve=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.props.room,n=t.missions.length,a=t.missions[n-1],o=t.members,c=ue[t.members.length][a.num];return r.a.createElement("div",{className:"ui form"},r.a.createElement("h4",{className:"ui dividing header"},"You are the Leader. Choose ",c," operatives for this mission"),o.map(function(t,n){return r.a.createElement("div",{className:"field",key:t.login},r.a.createElement("div",{className:"ui checkbox",onClick:function(){e.toggleParticipant(n)}},r.a.createElement("input",{type:"checkbox",className:"hidden",checked:a.participants.includes(n),value:n,onChange:function(){}}),r.a.createElement("label",null,t.login)))}),a.participants.length===c&&r.a.createElement("button",{className:"ui positive fluid button",onClick:function(){return e.propose()}},"Propose team"))}},{key:"toggleParticipant",value:function(e){var t=this.props,n=t.roomId,a=t.api,r=t.room;a.updateCurrentMission(n,function(t){var n=t.participants,a=ue[r.members.length][t.num];return n.includes(e)?Object(i.a)({},t,{participants:n.filter(function(t){return t!==e})}):n.length<a?Object(i.a)({},t,{participants:[].concat(Object(O.a)(n),[e])}):t})}},{key:"propose",value:function(){var e=this.props,t=e.api,n=e.roomId;t.proposeTeam(n)}}]),t}(r.a.Component),We=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.room,t=e.missions.length,n=e.missions[t-1];return r.a.createElement(r.a.Fragment,null,n.status===w.PREPARE&&r.a.createElement("div",{className:"ui yellow message"},r.a.createElement("div",{className:"header"},"Waiting for the Leader to propose a team")),n.status===w.VOTE&&r.a.createElement("div",{className:"ui blue message"},r.a.createElement("div",{className:"header"},"Approve or reject this team")),n.status===w.PROGRESS&&r.a.createElement("div",{className:"ui blue message"},r.a.createElement("div",{className:"header"},"Mission is in progress")),n.status===w.REJECTED&&r.a.createElement("div",{className:"ui message"},r.a.createElement("div",{className:"header"},"The team was rejected by the majority")),n.status===w.FAIL&&r.a.createElement("div",{className:"ui red message"},r.a.createElement("div",{className:"header"},"The team has failed your expectations")),n.status===w.SUCCESS&&r.a.createElement("div",{className:"ui green message"},r.a.createElement("div",{className:"header"},"The team was successful")))}}]),t}(r.a.Component),He=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.user,n=e.room,a=n.missions.length,o=n.missions[a-1],c=n.members,i=c[o.leader],s=i.login===t.login?t.role:ae(t.role,i.role);return r.a.createElement(r.a.Fragment,null,r.a.createElement(We,{room:n}),r.a.createElement("h3",{className:"ui header"},r.a.createElement("img",{alt:"leader role",className:"ui avatar image",src:Z[s].icon}),r.a.createElement("div",{className:"content"},"Leader ",i.login,Z[s].title&&r.a.createElement("div",{className:"sub header"},Z[s].title))),r.a.createElement("div",{className:"content"},"Proposed operatives:"),r.a.createElement("div",{className:"ui list"},o.participants.map(function(e){var n=c[e],a=n.login===t.login?t.role:ae(t.role,n.originalRole);return r.a.createElement("div",{className:"item",key:e},r.a.createElement("img",{alt:"role",className:"ui avatar image",src:Z[a].icon}),r.a.createElement("div",{className:"content"},r.a.createElement("div",{className:"header"},n.login),r.a.createElement("div",{className:"description"},Z[a].title)))})))}}]),t}(r.a.Component),Je=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.user,a=t.room,o=t.mission.vote,c=(void 0===o?{}:o)[a.members.findIndex(function(e){return e.login===n.login})];return c?c===M.YES?r.a.createElement("div",{className:"ui green message"},r.a.createElement("div",{className:"header"},"You approved the mission. Waiting for other player to vote")):r.a.createElement("div",{className:"ui red message"},r.a.createElement("div",{className:"header"},"You rejected the mission. Waiting for other player to vote")):r.a.createElement("div",{className:"ui fluid buttons"},r.a.createElement("button",{className:"ui red button",onClick:function(){return e.vote(M.NO)}},r.a.createElement("i",{className:"thumbs down icon"}),"Reject"),r.a.createElement("button",{className:"ui green button",onClick:function(){return e.vote(M.YES)}},r.a.createElement("i",{className:"thumbs up icon"}),"Approve"))}},{key:"vote",value:function(e){var t=this.props,n=t.roomId,a=t.api,r=t.room,o=t.user,c=r.members.findIndex(function(e){return e.login===o.login});a.voteTeam(n,c,e)}}]),t}(r.a.Component),Ke=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.user,n=e.room,a=e.mission;if((t.role===X.DEFECTOR||t.role===X.SPY_DEFECTOR)&&n.defectorTurn.includes(a.num)){var o=t.role===X.DEFECTOR?Z[X.SPY_DEFECTOR]:Z[X.DEFECTOR];return r.a.createElement("div",{className:"ui fluid card"},r.a.createElement("div",{className:"content"},r.a.createElement("img",{alt:"new role",className:"right floated small ui image",src:o.icon}),r.a.createElement("div",{className:"header"},"Your allegiance has changed"),r.a.createElement("div",{className:"meta"},"Defector action"),r.a.createElement("div",{className:"description"},"From the next turn you are sided with ",r.a.createElement("b",{className:$[o.side].color},$[o.side].title))))}return null}}]),t}(r.a.Component),ze=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.room,n=e.mission;return r.a.createElement("div",{className:"ui  divided list"},t.members.map(function(e,t){return r.a.createElement("div",{className:"item",key:e.login},r.a.createElement("div",{className:"right floated content"},n.vote[t]===M.YES?r.a.createElement("i",{className:"thumbs up icon success text"}):r.a.createElement("i",{className:"thumbs down icon danger text"})),r.a.createElement("div",{className:"content"},e.login))}))}}]),t}(r.a.Component),qe=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.mission,a=t.user,o=t.room;if(!n.participants.includes(a.num)||n.result&&n.result[a.num])return null;var c,i=(c=a.role,o.members.length,c===X.DEFECTOR||Z[c].side===I.BAD?[F.FAIL,F.SUCCESS]:[F.SUCCESS]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("h4",{className:"ui message"},r.a.createElement("div",{className:"header"},"You were selected for the mission"),r.a.createElement("p",null,"Vote for the outcome")),r.a.createElement("div",{className:"ui fluid buttons"},i.includes(F.FAIL)&&r.a.createElement("button",{className:"ui negative button",onClick:function(){return e.vote(F.FAIL)}},"Fail"),i.includes(F.SUCCESS)&&r.a.createElement("button",{className:"ui positive button",onClick:function(){return e.vote(F.SUCCESS)}},"Success")))}},{key:"vote",value:function(e){var t=this.props,n=t.roomId,a=t.user;t.api.performMission(n,a.num,e)}}]),t}(r.a.Component),Qe=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.user,a=t.room,o=t.api,c=t.roomId,i=a.missions.length,s=a.missions[i-1],u=a.members[s.leader],l=s.status===w.PREPARE&&u.login===n.login;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",{className:"ui center aligned header"},"Mission N",s.num+1,' "The ',s.name,'"'),l&&r.a.createElement(Ve,{room:a,api:o,roomId:c}),!l&&r.a.createElement(He,{room:a,api:o,roomId:c,user:n}),r.a.createElement(Ke,{user:n,room:a,mission:s}),s.status===w.VOTE&&r.a.createElement(Je,{room:a,user:n,api:o,mission:s,roomId:c}),s.status===w.PROGRESS&&r.a.createElement(qe,{room:a,user:n,api:o,mission:s,roomId:c}),s.status===w.PROGRESS&&n.host&&a.members.some(function(e){return e.bot})&&r.a.createElement("button",{className:"ui primary button",onClick:function(){return e.botVote()}},"Bot actions"),(s.status===w.PROGRESS||w.isTerminal(s.status))&&r.a.createElement(ze,{room:a,mission:s}),w.isTerminal(s.status)&&n.host&&r.a.createElement("button",{className:"ui fluid primary button",onClick:function(){return e.nextMission()}},"Next mission"))}},{key:"botVote",value:function(){var e=this.props,t=e.roomId;e.api.botMissionPerfom(t)}},{key:"nextMission",value:function(){var e=this.props,t=e.roomId;e.api.nextMission(t)}}]),t}(r.a.Component),Xe=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.room.score;return e[I.BAD]>e[I.GOOD]?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{alt:"winner",className:"ui medium circular image centered",src:Z[X.SPY].icon}),r.a.createElement("h2",{className:"ui center aligned header ".concat($[I.BAD].color)},"The Spies Won")):r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{alt:"winner",className:"ui medium circular image centered",src:Z[X.RESISTANCE].icon}),r.a.createElement("h2",{className:"ui center aligned header ".concat($[I.GOOD].color)},"The Resistance Won"))}}]),t}(r.a.Component),Ze=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.room,n=e.api,a=e.roomId,o=e.user,c=t.status;return r.a.createElement(r.a.Fragment,null,c===k.NEW&&r.a.createElement(Ue,{room:t,api:n,roomId:a,user:o}),c===k.STARTED&&r.a.createElement(Qe,{room:t,api:n,roomId:a,user:o}),c===k.FINISHED&&r.a.createElement(Xe,{room:t}))}}]),t}(r.a.Component),$e=n(333),et=n(4),tt=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.room,t=e.missions,n=e.score,a=e.members;return e.status===k.NEW?r.a.createElement("h3",{className:"ui center aligned header"},"Game is not started yet"):r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",{className:"ui center aligned header"},r.a.createElement("span",{className:$[I.GOOD].color},n[I.GOOD]),"\xa0:\xa0",r.a.createElement("span",{className:$[I.BAD].color},n[I.BAD])),t.map(function(e,t){return r.a.createElement("div",{className:"ui fluid card",key:t},r.a.createElement("div",{className:"content"},r.a.createElement("div",{className:"header ".concat(et({success:e.status===w.SUCCESS,danger:e.status===w.FAIL})," text")},"The ",e.name),r.a.createElement("div",{className:"meta"},P[e.status]),r.a.createElement("div",{className:"description"},r.a.createElement("p",null,"Leader: ",a[e.leader].login),w.isLater(w.PREPARE,e.status)&&r.a.createElement("p",null,"Operatives: ",e.participants.map(function(e,t){return[t>0&&", ",r.a.createElement("span",{key:e},a[e].login)]})),w.isLater(w.VOTE,e.status)&&r.a.createElement("div",{className:"ui mini horizontal divided list"},Object.entries(e.vote).map(function(e){var t=Object($e.a)(e,2),n=t[0],o=t[1];return r.a.createElement("div",{className:"item",key:n},o===M.YES?r.a.createElement("i",{className:"thumbs up icon success text"}):r.a.createElement("i",{className:"thumbs down icon danger text"}),r.a.createElement("div",{className:"content"},r.a.createElement("div",{className:"header"},a[n].login)))})))),e.result&&w.isLater(w.PROGRESS,e.status)&&r.a.createElement("div",{className:"extra content center aligned"},"Results:",Object.values(e.result).map(function(e,t){return e===F.FAIL?r.a.createElement("i",{className:"ui icon close danger text",key:t}):r.a.createElement("i",{className:"ui icon check success text",key:t})})))}))}}]),t}(r.a.Component),nt={BOARD:"BOARD",MEMBERS:"MEMBERS",HISTORY:"HISTORY"},at=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={room:null,errMsg:null,tab:nt.BOARD},n.removeListener=null,n.start=function(){n.clearErr();var e=n.state.room,t=n.props.roomId;e.status===k.NEW&&e.members.length>=1&&e.members.length<10&&Ie.start(t).catch(function(e){n.setState({errMsg:e.message||"Unknown error"})})},n.end=function(){n.clearErr();var e=n.props.roomId;Ie.end(e).catch(function(e){n.setState({errMsg:e.message||"Unknown error"})})},n.clearErr=function(){n.setState({errMsg:null})},n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.login,a=t.roomId,o=t.setVision,c=this.state,i=c.room,s=c.errMsg,u=c.tab,l=i&&i.members.find(function(e){return e.login===n});return l&&i?r.a.createElement("div",{className:"room"},s&&r.a.createElement("div",{className:"ui negative message room-msg"},r.a.createElement("div",{className:"header"},"Something went wrong"),r.a.createElement("p",null,s)),r.a.createElement("div",{className:"room-content"},u===nt.MEMBERS&&r.a.createElement(Ge,{room:i,user:l,api:Ie,roomId:a,onLeave:function(){return e.leave()},setVision:o}),u===nt.BOARD&&r.a.createElement(Ze,{room:i,user:l,roomId:a,api:Ie}),u===nt.HISTORY&&r.a.createElement(tt,{room:i,user:l})),r.a.createElement(Pe,{onTabSet:function(t){return e.setState({tab:t})},tab:u})):r.a.createElement(Fe.a,{centered:"true",as:"h5"},"Searching for a room")}},{key:"componentDidMount",value:function(){var e=this,t=this.props.roomId;this.removeListener=Ie.listenRoom(t,function(t){e.setState({room:t.data()})})}},{key:"componentWillUnmount",value:function(){this.removeListener&&(this.removeListener(),this.removeListener=null)}},{key:"leave",value:function(){var e=this.props.onLeave;e&&e()}}]),t}(r.a.Component);var rt={setCred:function(e){localStorage.setItem("cred",JSON.stringify(e))},getCred:function(){var e=localStorage.getItem("cred");return e?JSON.parse(e):null},clearCred:function(){localStorage.removeItem("cred")}},ot=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={roomId:null,login:null,secret:null,ready:!1},n.onEnter=function(e){rt.setCred(e),n.setState(Object(i.a)({},e))},n.onLeave=function(){rt.clearCred(),window.location=""},n.setVision=function(e){n.setState({login:e})},n.tryLogin=function(){var e=xe(),t=rt.getCred();!t||e&&t.roomId!==e||Ie.login(t).then(function(){n.setState(Object(i.a)({},t))}).catch(function(e){console.error("Failed to rejoin the game",e)})},n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state,t=e.roomId,n=e.login,a=e.secret;return r.a.createElement(r.a.Fragment,null,!t&&r.a.createElement(Me,{onEnter:this.onEnter}),t&&r.a.createElement(at,{roomId:t,login:n,secret:a,onLeave:this.onLeave,setVision:this.setVision}))}},{key:"componentDidMount",value:function(){this.tryLogin()}}]),t}(r.a.Component);c.a.render(r.a.createElement(ot,null),document.getElementById("root"))}},[[343,1,2]]]);
//# sourceMappingURL=main.b6d1e5e2.chunk.js.map